developer_instructions = """
- После выполнения каждой задачи подготовь текст названия коммита в формате Conventional Commits. 
- Всегда отвечай по-русски и самостоятельно выполняй любые доступные рутинные действия (сборки, тесты, линтеры, проверки команд и сервисов), пока это не запрещено окружением. 
- Выполняй команды сам и делись результатом, а не перекладывай это на пользователя. 
- Не оставляй в репозитории временные или вспомогательные файлы — используй временные директории или удаляй такие файлы сразу после завершения задачи.

=== КРИТИЧЕСКИ ВАЖНО: РАБОТА С ФАЙЛАМИ ДОКУМЕНТАЦИИ ===

**НИКОГДА не создавай дубликаты файлов документации!**

1. **При работе с файлами в Releases/ (стори, планы, документация):**
   - ВСЕГДА редактируй СУЩЕСТВУЮЩИЕ файлы, а не создавай новые
   - Если файл уже существует (например, `1-us-выбор-баз-знаний-DONE.md`), редактируй ЕГО
   - НЕ создавай файлы без суффикса `-DONE`, если уже есть файл с `-DONE`
   - **КРИТИЧНО:** При переименовании используй ТОЛЬКО `mv` или `run_terminal_cmd` с `mv`, НИКОГДА не используй `write` для создания файла с новым именем

2. **Правило работы со стори-документами:**
   - Если файл существует → редактировать существующий (используй `search_replace` или `read_file` + `search_replace`)
   - Если файла нет → создать новый (используй `write`)
   - **При завершении стори:**
     - СНАЧАЛА обновить критерии готовности в существующем файле через `search_replace`
     - ЗАТЕМ переименовать файл в `-DONE.md` ТОЛЬКО через `run_terminal_cmd` с командой `mv`
     - **ЗАПРЕЩЕНО:** использовать `write` для создания файла с `-DONE` в названии

3. **Проверка перед созданием/переименованием файла:**
   - **Перед созданием:** проверить через `list_dir` или `glob_file_search`, нет ли уже файла с таким именем (с `-DONE` или без)
   - **Перед переименованием:** убедиться, что исходный файл существует, и использовать ТОЛЬКО `mv` через `run_terminal_cmd`
   - Если файл с `-DONE` уже существует → редактировать его, а не создавать новый

4. **Алгоритм переименования стори в DONE:**
   ```
   1. Прочитать существующий файл (например, `1-us-стори.md`)
   2. Обновить критерии готовности через `search_replace` (пометить как выполненные)
   3. Проверить через `list_dir`, что файла с `-DONE` еще нет
   4. Выполнить `run_terminal_cmd` с командой `mv "путь/к/файлу.md" "путь/к/файлу-DONE.md"`
   5. НИКОГДА не использовать `write` для создания файла с `-DONE`
   ```

=== КРИТИЧЕСКИ ВАЖНО: ОБНОВЛЕНИЕ ДОКУМЕНТАЦИИ И ТЕСТОВ ===

При ЛЮБОМ изменении кода ОБЯЗАТЕЛЬНО проверять и обновлять связанные файлы:

1. **При изменении функционала:**
   - Обновить unit тесты в `tests/` (или добавить новые)
   - Обновить e2e тесты в `e2e/` (если критично)
   - Обновить тест-кейсы в `Releases/test-cases/modules/`
   - Обновить документацию в `docs/public-docs/` (если менялся API)
   - Обновить user-guide в `Releases/user-guide/` (если менялся пользовательский функционал)

2. **Процесс работы:**
   - После изменения кода: проанализировать изменения → определить затронутые файлы → спросить пользователя "Обновить документацию и тесты?" → если "да" - выполнить обновления автоматически
   - При создании нового функционала: создать код → создать тесты → спросить "Добавить тест-кейсы и обновить документацию?" → если "да" - выполнить
   - При исправлении бага: исправить код → добавить тест → спросить "Обновить тест-кейсы и документацию?" → если "да" - выполнить

3. **Маппинг изменений:**
   - `server/routes.ts` → `docs/public-docs/api-inventory.md`, `docs/public-docs/no-code-blocks-api-guide.md`, тесты
   - `client/src/pages/` → `Releases/user-guide/`, `Releases/test-cases/modules/`, `e2e/`
   - No-code → `Releases/user-guide/no-code-integration.md`, `Releases/test-cases/modules/no-code-integration.md`, `docs/public-docs/no-code-blocks-api-guide.md`
   - Админка → `Releases/user-guide/admin-panel.md`, `Releases/test-cases/modules/admin-panel.md`
   - И т.д. (см. `.cursorrules` для полного списка)

4. **Формат ссылок в user-guide:**
   - ВСЕ ссылки должны быть в формате Confluence: `https://wiki.hopper-it.ru/display/AI/{filename}?src=contextnavpagetreemode`
   - С якорем: `?src=contextnavpagetreemode#anchor`

5. **Перед коммитом:**
   - Проверить, что все связанные файлы обновлены
   - Если нет - предложить обновить перед коммитом

ПОДРОБНЫЕ ПРАВИЛА: см. `.cursorrules` в корне проекта

"""