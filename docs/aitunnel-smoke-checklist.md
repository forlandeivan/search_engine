# Smoke-чеклист для AITunnel (до/после выкладки)

Режим: ручные проверки с рабочим API-ключом. Важно: не выполнять на продовом ключе без согласования.

## Подготовка
- Настрой в воркспейсе провайдер `AITunnel`:
  - API ключ `sk-aitunnel-...`
  - Модель по умолчанию: `gpt-5.1-chat`
- Убедись, что recommended models видны в UI.
- Запусти dev-скрипт `ts-node server/dev/check-aitunnel-models.ts` с переменной `AITUNNEL_API_KEY` — сверить, что модели из списка существуют.

## Чат / обычный completion
1. Отправь простой промпт в чат (non-stream).
2. Должен прийти ответ, в логах LLM-запусков:
   - provider = aitunnel
   - model = выбранная
   - usage (prompt/completion/total) заполнен
   - finish_reason = stop

## Стриминг
1. Включи потоковый режим (тот же чат, но с печатанием).
2. Убедись, что UI “печатает” текст, события приходят без ошибок.

## Другие модели
1. Выбери `deepseek-r1`, отправь промпт (non-stream + stream) — формат ответа не ломается.
2. Выбери `claude-3.7-sonnet` — аналогично.

## Автодействия/саммари/RAG
1. Навык с автодействием (summaries) — после транскрипции должен использовать выбранный провайдер, карточка превью обновляется.
2. RAG-поиск: ответ приходит, usage считается.

## Регрессия GigaChat
1. Переключи воркспейс на GigaChat, повтори чат/стрим/саммари/RAG — всё должно работать как раньше.
2. В логах запусков LLM корректно различаются провайдеры (provider = gigachat/aitunnel).

## Ошибки
- Неверный ключ → понятная ошибка “unauthorized”.
- Ошибка в стриме → поток завершается, сообщение ассистента не создаётся, в логах статус error.

## Перед релизом
- Актуализируй recommended models согласно `/v1/models`.
- Пройти чеклист на dev/stage со свежими ключами.
