# Режим обслуживания

## Что это
Режим обслуживания — это состояние системы, при котором обычные пользователи временно не могут пользоваться продуктом. Вместо интерфейса они видят экран недоступности. Для запланированного обслуживания пользователям заранее показывается баннер.

## Где находится настройка
Админка → Настройки → Режим обслуживания.
Путь в браузере: `/admin/settings/maintenance`.

## Параметры
- Интервал обслуживания. Дата и время начала и окончания. Обязательны оба значения.
- Часовой пояс. Влияет на ввод времени и отображение интервалов в журнале.
- Заголовок для пользователей. Показывается на экране недоступности и в баннере.
- Описание для страницы заглушки. Показывается на экране недоступности и в баннере.
- Время восстановления (ETA). Показывается пользователям как ожидаемое время восстановления.
- Экстренное включение. Включает обслуживание сразу, без расписания.

## Как запланировать обслуживание
1. Откройте страницу режима обслуживания в админке.
2. Выберите часовой пояс.
3. Нажмите «Запланировать».
4. Укажите дату и время начала и окончания.
5. При необходимости заполните заголовок, описание и ETA.
6. Нажмите «Сохранить».

## Как включить и выключить вручную
1. Нажмите «Экстренно включить» и подтвердите действие.
2. Чтобы изменить сообщения, нажмите «Редактировать» в журнале для экстренного режима.
3. Чтобы выключить, нажмите «Отключить» и подтвердите действие.

## Что увидят пользователи
- Баннер показывается только при статусе «Запланирован». Если до начала больше 24 часов, баннер не отображается.
- Цвет баннера зависит от времени до начала.
- Нейтральный, когда до начала больше 1 часа и не больше 24 часов.
- Жёлтый, когда до начала 1 час или меньше.
- Красный, когда до начала 15 минут или меньше.
- Экран недоступности показывается при активном режиме обслуживания.
- Заголовок и описание берутся из настроек интервала или экстренного режима. Если они не заполнены, показываются стандартные тексты.
- ETA берётся из поля «Время восстановления». Если оно пустое и есть время окончания интервала, показывается время окончания. Если окончание уже прошло, ETA не показывается.

## Поведение для администраторов
- Во время активного обслуживания администратор может открыть страницу режима обслуживания. Остальные разделы админки блокируются экраном недоступности.
- Баннер о плановом обслуживании показывается и в админке.

## Типовые ошибки и как их избежать
- Заполнена только дата или только время. Нужно указать обе части.
- Окончание раньше начала. Проверьте даты и время.
- Неверный формат времени. Используйте формат HH:mm.
- Баннер не виден, если до начала больше 24 часов. Это ожидаемое поведение.

## FAQ
**Почему я не вижу баннер?**
Баннер показывается только когда до начала обслуживания 24 часа или меньше. Проверьте время начала и часовой пояс.

**Почему не отображается время восстановления?**
Заполните поле «Время восстановления». Если оно пустое, будет показано время окончания интервала, если оно ещё не прошло.

**Почему администратор не видит админку во время обслуживания?**
Во время активного режима админка доступна только на странице режима обслуживания. Остальные разделы блокируются.

**Что показывается, если статус обслуживания недоступен?**
Система показывает экран «Сервис временно недоступен» и рекомендует попробовать обновить страницу позже.
