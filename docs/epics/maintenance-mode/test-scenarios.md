# Тестовые сценарии: режим обслуживания (MVP)

## Позитивные сценарии

### ПС‑01. Баннер при плановом обслуживании
**Предусловия:** задан плановый интервал (start/end в будущем).
**Шаги:**
1. Авторизованный пользователь открывает `ChatPage`.
2. Гость открывает `AuthPage`.
**Ожидаемый результат:**
- Баннер отображается у обоих пользователей.

### ПС‑02. Активное обслуживание — блокировка API
**Предусловия:** режим активен.
**Шаги:**
1. GET `/api/chat/sessions`.
**Ожидаемый результат:**
- Ответ 503 + `errorCode=MAINTENANCE_MODE`.

### ПС‑03. Публичный статус
**Предусловия:** режим активен.
**Шаги:**
1. GET `/api/maintenance/status`.
**Ожидаемый результат:**
- Ответ 200 с корректным статусом.

---

## Негативные сценарии

### НС‑01. Не‑admin пытается изменить настройки
**Предусловия:** пользователь с ролью `user`.
**Шаги:**
1. PUT `/api/admin/settings/maintenance`.
**Ожидаемый результат:**
- 403 и запись об инциденте в логах.

### НС‑02. Некорректные даты интервала
**Предусловия:** администратор открывает форму.
**Шаги:**
1. Задать `scheduledStartAt` позже `scheduledEndAt`.
**Ожидаемый результат:**
- Ошибка валидации, изменения не сохраняются.

---

## Граничные случаи

### ГС‑01. Ровно в момент старта
**Предусловия:** `scheduledStartAt = now`.
**Шаги:**
1. Пользователь делает запрос в момент старта.
**Ожидаемый результат:**
- Запрос либо проходит полностью, либо отклоняется без частичных изменений.

### ГС‑02. Нет сообщений в настройках
**Предусловия:** активный режим без messageTitle/messageBody.
**Шаги:**
1. Открыть любую страницу.
**Ожидаемый результат:**
- Показывается дефолтный текст.

---

## Сценарии блокировки входа

### ВХ‑01. Вход во время активного режима
**Предусловия:** режим активен.
**Шаги:**
1. Открыть `/auth`.
2. Попытаться авторизоваться.
**Ожидаемый результат:**
- Форма входа недоступна.
- Показывается экран обслуживания.

---

## Реальное время

### РТ‑01. Экстренное включение в активной сессии
**Предусловия:** пользователь открыт в чате.
**Шаги:**
1. Админ включает режим.
**Ожидаемый результат:**
- UI переходит к экрану обслуживания без перезагрузки.

### РТ‑02. Завершение обслуживания
**Предусловия:** режим активен.
**Шаги:**
1. Админ выключает режим.
**Ожидаемый результат:**
- UI возвращается к нормальному состоянию.
