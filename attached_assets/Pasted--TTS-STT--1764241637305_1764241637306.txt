Опишу, что уже есть в бэкенде по TTS/STT провайдерам и как это будет использоваться для будущего аудио-клипса в чате.

Что реализовано сейчас (бэкенд)
Хранение провайдеров

Таблицы speech_providers и speech_provider_secrets (см. server/storage.ts): держат описание провайдера (id, displayName, providerType, direction, статус, включён/выключен, updatedAt/updatedBy), и секреты (ключ/значение).
При инициализации создаётся встроенный STT‑провайдер yandex_speechkit с нужными полями, providerType="builtin", direction="audio_to_text", status и isEnabled.
Конфиг и секреты ограничены whitelists: config — languageCode, model, enablePunctuation; secrets — apiKey, folderId.
Сервис speech-provider-service.ts

listProviders() — отдаёт summaries для UI (id, displayName, providerType, direction, статус, isEnabled, updatedAt, lastStatusChangedAt).
getProviderById() — отдаёт detail: provider + config + флаги установленных секретов.
updateProviderConfig(opts) — только для встроенного провайдера; мержит config по whitelists, патчит секреты (clear или новое значение), может включать/выключать (isEnabled), проставляет lastValidationAt, сбрасывает ошибки при включении. Если провайдер выключен — статус Disabled и ошибки чистятся.
Ошибки: SpeechProviderNotFoundError (404), SpeechProviderDisabledError (503), базовый SpeechProviderServiceError (400 для неподдерживаемых действий).
Роуты server/routes.ts (админские)

GET /api/admin/speech/providers — список провайдеров (listProviders).
GET /api/admin/speech/providers/:id — detail (getProviderById).
PATCH /api/admin/speech/providers/:id — обновление config/secrets/isEnabled, с rate-limitом на админа (в памяти, speechProviderRateLimitBuckets).
Схемы входа: config (whitelist ключей), secrets (массив { key, value?, clear? }).
Статусы/включение

В updateProviderConfig можно включать/выключать. При выключении обнуляются lastError*. При ошибках валидации (опционально validateExternally) можно проставлять lastErrorCode/Message и статус.
Фронт-админка

Страницы client/src/pages/TtsSttProvidersPage.tsx (список) и SpeechProviderDetailsPage.tsx (detail) используют хуки useSpeechProviders и типы SpeechProviderSummary/Detail.
Можно видеть/менять isEnabled, редактировать config (язык/модель/пунктуацию) и секреты (apiKey, folderId), включить/отключить провайдера.
Как это ляжет на “скрепку” в чате (прикрепление аудио)
Пока в чате нет готового UI/роутов для аудио, но опираясь на существующий слой провайдеров, сценарий выглядит так:

Выбор провайдера и конфиг

Админ настраивает STT/TTS в админке (встроенный yandex_speechkit), включает провайдер.
В конфиге задаются язык, модель, пунктуация; в секретах — apiKey, folderId.
Использование в чате (будущее)

Для STT (аудио → текст): при загрузке аудио через “скрепку” фронт будет отправлять файл на новый API (ещё не реализован). Бэкенд возьмёт активный провайдер (isEnabled), проверит статус, подставит config/secrets и дернёт SpeechKit.